# OPSKE Agent — Εγχειρίδιο Χρήσης (Ελληνικά)

## 📌 Εισαγωγή
Το **OPSKE Agent** είναι μια αυτοματοποιημένη εφαρμογή (Python + Playwright + Tkinter GUI) που διευκολύνει την υποβολή δικαιολογητικών στο πληροφοριακό σύστημα **ΟΠΣΚΕ**.  
Ο χρήστης εισάγει ένα Excel αρχείο και έναν φάκελο με τα αρχεία προς υποβολή, και το εργαλείο:

- Ελέγχει τη δομή και την εγκυρότητα των δεδομένων
- Επαληθεύει ότι όλα τα δικαιολογητικά είναι σωστά και σύμφωνα με τις απαιτήσεις
- Συμπληρώνει αυτόματα τα πεδία στο ΟΠΣΚΕ
- Ανεβάζει τα αρχεία
- Κάνει **Αποθήκευση** ή **Οριστική Υποβολή**
- Ενημερώνει το Excel με την κατάσταση κάθε εγγράφου

---

# 🗂 1. Απαιτήσεις Συστήματος

- Python 3.10+
- Playwright (εγκαθίσταται μέσω requirements)
- Google Chrome ή Chromium
- Σύνδεση στο διαδίκτυο
- Λογαριασμός στο ΟΠΣΚΕ (AADE login)

---

# ⚙ 2. Εγκατάσταση

1. Κατεβάστε ή κλωνοποιήστε το repository.
2. Εγκαταστήστε τα απαραίτητα πακέτα:

```bash
pip install -r requirements.txt
```

3. Εκτελέστε την εφαρμογή:

```bash
python opske_agent.py
```

---

# 📊 3. Δομή του Excel αρχείου

Το Excel πρέπει να περιέχει **υποχρεωτικά** τις εξής στήλες:

- **Επωνυμία – ΑΦΜ**  
  Μορφή: «Εταιρία – #########». Περιλαμβάνει έλεγχο εγκυρότητας ΑΦΜ.

- **Κωδικός έργου**  
  Π.χ. `PROJECTNAME-12345`.

- **Κωδικός Δικαιολογητικού**  
  Μορφή `NN.NN` (π.χ. `01.03`).

- **Όνομα αρχείου**  
  Το βασικό όνομα του αρχείου (χωρίς κατάληξη), για αντιστοίχιση με τον φάκελο.

- **Ημερομηνία έκδοσης δικαιολογητικού**  
  Έγκυρη ημερομηνία — όχι μελλοντική.

- **Ημερομηνία λήξης δικαιολογητικού**  
  Έγκυρη ημερομηνία — όχι παρελθοντική.

- **Παρατηρήσεις ΟΠΣΚΕ**  
  Προαιρετικές σημειώσεις που περνούν στο αντίστοιχο πεδίο.

---

# 📂 4. Έλεγχος Αρχείων

Πριν από την υποβολή, το πρόγραμμα ελέγχει:

### ✔ Επέκταση αρχείου  
Επιτρέπονται μόνο:
- `pdf`, `jpg`, `jpeg`, `png`

### ✔ Μέγεθος αρχείου  
Μέγιστο: **10MB**

### ✔ Ονομασία αρχείου  
Γίνεται αντιστοίχιση βάσει του `Όνομα αρχείου` από το Excel.

Αν κάποιο αρχείο λείπει ή απορρίπτεται, εμφανίζεται στο GUI.

---

# 🖥 5. Περιγραφή GUI

Το GUI προσφέρει:

- Επιλογή Excel
- Επιλογή φακέλου
- Έλεγχο Excel & Αρχείων
- Έναρξη για **Αποθήκευση**
- Έναρξη για **Υποβολή**
- Pause/Play
- Μπάρα προόδου
- Λίστα τρέχουσας ενέργειας
- Λίστα αποτελεσμάτων
- Σύνοψη προβλημάτων

---

# 🔄 6. Διαδικασία Αυτόματης Υποβολής

Για κάθε έγκυρη γραμμή:

1. Επιλογή δικαιούχου, έργου, δικαιολογητικού  
2. Συμπλήρωση παρατηρήσεων  
3. Επιλογή ημερομηνιών μέσω date picker  
4. Αποστολή αρχείου  
5. Αποθήκευση ή Υποβολή  
6. Επιστροφή στην αρχική σελίδα  
7. Ενημέρωση του Excel

---

# 🛡 7. Διαχείριση Σφαλμάτων

Το εργαλείο εμφανίζει:

- Σφάλματα Excel
- Αρχεία που λείπουν
- Μη επιτρεπτούς τύπους
- Υπερβάσεις μεγέθους
- Σφάλματα από το ΟΠΣΚΕ (όταν ανιχνεύονται)

Η ενότητα **Σύνοψη** συγκεντρώνει όλες τις πληροφορίες για εύκολη ανασκόπηση.

---

# 📁 8. Ενημέρωση Excel

Μετά από κάθε επιτυχία ενημερώνονται αυτόματα:

- `Αποθήκευση`
- `Υποβολή`
- `Ημ/νία & ώρα υποβολής`

---

# 🧾 9. Σημαντικές Σημειώσεις

- Το ΟΠΣΚΕ δεν παρέχει API. Η αυτοματοποίηση γίνεται μέσω UI.  
- Αλλαγές στην πλατφόρμα μπορεί να απαιτήσουν ενημέρωση του εργαλείου.  
- Απαιτείται σταθερή σύνδεση στο διαδίκτυο.  
- Ο χρήστης είναι υπεύθυνος για την ασφαλή χρήση και τα δεδομένα.

---

# ✔ Τέλος Εγχειριδίου

Για απορίες ή προτάσεις βελτίωσης, ανοίξτε issue στο GitHub.
